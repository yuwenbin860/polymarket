---
name: polymarket-dev-guidelines
description: Polymarket套利系统开发准则：小步快跑、进度持久化、开放创新、核心聚焦、LLM赋能、实证优先、策略迭代、交互优先、渐进披露、即时反馈、可扩展架构。在开发任务、架构决策、优先级判断时自动引用。
---

# Polymarket 开发准则

本项目遵循11条核心开发准则，在执行任何开发任务时都应参考这些原则。

## 2.1 小步快跑 (Incremental Progress)

**原则**：将宏大目标拆分为小目标，每个小目标独立验证后再进行下一步。

```
宏大目标
├── 小目标 1 ← 实现 → 验证
├── 小目标 2 ← 实现 → 验证
├── 小目标 3 ← 实现 → 验证
└── ...
```

**执行要点**：
- 每个小目标应该可以在1-3小时内完成验证
- 验证失败时及时调整方向，避免沉没成本
- **里程碑级完成** → 更新 `docs/WORK_PLAN.md`
- **明细级进度** → 记录 `docs/PROGRESS.md`
- 开发中善用 agents 处理复杂任务（可以查看我们的agents列表进行选择）
- 代码提交前用进行code review(可以使用agent) 检查，避免低级错误

## 2.2 进度持久化 (Progress Persistence)

**原则**：分层记录进度，确保随时可恢复工作上下文。

**文档分工**：
| 文档 | 职责 | 更新时机 |
|------|------|---------|
| `docs/WORK_PLAN.md` | 里程碑、阶段状态、下一步工作 | 完成阶段/重要版本时 |
| `docs/PROGRESS.md` | 详细工作日志、代码变更明细 | 每次工作会话 |

**执行要点**：
- **里程碑和阶段进度** → 更新到 `docs/WORK_PLAN.md`
  - 阶段完成度、版本节点、任务状态
  - 用于查看下一步工作方向
- **详细工作日志** → 记录到 `docs/PROGRESS.md`
  - 每次会话的具体变更
  - Bug修复、代码变更等明细
- 实现与圣经计划对比，偏差时确认是更新圣经还是修正实现
- 确保在任何时间、任何地点都能快速恢复工作上下文

## 2.3 开放创新 (Open Innovation)

**原则**：欢迎任何能改进套利系统的新点子，经确认后记录。

**执行要点**：
- 新点子先记录到 `docs/PROJECT_BIBLE.md` 的[创意池](第15章)
- 讨论确认可行性后，纳入正式开发计划
- 保持系统活力，不断迭代优化

## 2.4 核心聚焦 (Core Focus)

**原则**：套利是核心中的核心，发现机会比执行更重要。

```
优先级金字塔：

        ┌─────────────┐
        │  发现套利   │  ← 最高优先级
        │   机会      │
        ├─────────────┤
        │  LLM关系    │  ← 高优先级
        │   分析      │
        ├─────────────┤
        │  数据获取   │  ← 中优先级
        │   处理      │
        ├─────────────┤
        │  执行下单   │  ← 低优先级（可人工）
        │   监控      │
        └─────────────┘
```

**执行要点**：
- 预留不同套利模式的接入口
- 执行和下单可以暂时人工，**发现机会才是关键**

## 2.5 LLM赋能 (LLM Empowerment)

**原则**：最大化利用LLM进行语义分析和逻辑推理。

**LLM在套利系统中的作用**：

| 任务 | LLM作用 | 重要程度 |
|------|---------|----------|
| 识别市场逻辑关系 | 核心能力 | ⭐⭐⭐⭐⭐ |
| 判断完备集完整性 | 辅助验证 | ⭐⭐⭐⭐ |
| 分析结算规则差异 | 风险提示 | ⭐⭐⭐⭐ |
| 生成套利建议 | 输出整理 | ⭐⭐⭐ |
| 边界情况分析 | 风险识别 | ⭐⭐⭐⭐ |

**执行要点**：
- 持续优化Prompt，提高关系识别准确率
- 探索多模型协作、交叉验证
- 记录LLM表现，用于持续改进

## 2.6 实证优先 (Evidence-First Approach)

**原则**：先验证真实套利机会存在，再设计识别算法。

**正确流程**：
```
1. 人工发现真实案例 → 2. 验证确实是套利 → 3. 设计识别算法 → 4. 实现并测试
```

**错误流程**：
```
1. 设计理论模型 → 2. 实现算法 → 3. 希望能找到套利（可能找不到）
```

**执行要点**：
- 每一种新套利类型，必须先有至少1个真实案例
- 人工验证该案例确实存在套利空间后，再投入开发
- 避免"闭门造车"——实践出真知

## 2.7 策略迭代 (Strategy Evolution)

**原则**：项目进行中发现新的套利策略，需及时提出并更新到圣经。

**执行流程**：
```
1. 发现新策略/模式 → 记录到创意池（第15章）
2. 讨论验证可行性 → 人工测试至少1个真实案例
3. 验证通过 → 正式更新到套利策略章节（第4章）
4. 规划实现 → 添加到开发路线图（第10章）
```

**执行要点**：
- 新发现不要遗忘，立即记录到创意池
- 经验证的策略及时"晋升"到正式章节
- 保持项目圣经作为"活文档"，持续演进

## 2.8 交互优先 (Interactive-First)

**原则**：用户界面设计以交互式体验为优先，命令行参数作为高级用法。

**执行要点**：
- 进入程序后默认显示交互式菜单
- 主菜单只显示核心操作（扫描、配置、帮助、退出）
- 命令行参数保留用于自动化脚本和高级用户
- 使用 `--no-interactive` 禁用交互式菜单进入CLI模式

**相关模块**：
- `cli/menu.py` - 交互式菜单系统
- `cli/output.py` - 规范化输出

## 2.9 渐进披露 (Progressive Disclosure)

**原则**：复杂配置和高级选项按需展开，不一次性展示所有选项。

**执行要点**：
- 主菜单只显示核心操作
- 高级选项按需展开
- 默认值对新手友好
- 复杂配置使用分步引导而非一次性表单

## 2.10 即时反馈 (Immediate Feedback)

**原则**：每个操作步骤都提供清晰的反馈，让用户知道系统在做什么。

**执行要点**：
- 每个步骤清楚显示正在做什么（获取哪些市场、执行哪个策略）
- 进度条显示耗时操作
- 发现机会时立即高亮显示
- 错误信息具有指导性，告诉用户如何解决而非只报错

## 2.11 可扩展架构 (Extensible Architecture)

**原则**：新增套利策略只需实现接口并注册，无需修改主流程。

**执行要点**：
- 新增套利策略只需实现 `BaseArbitrageStrategy` 接口
- 使用 `@StrategyRegistry.register` 装饰器注册
- 输出格式统一通过 `cli/output.py:ScannerOutput` 处理
- 策略优先级、领域过滤通过 `StrategyMetadata` 配置
- 菜单系统自动发现已注册策略，无需手动维护选项列表

**策略注册示例**：
```python
from strategies import BaseArbitrageStrategy, StrategyMetadata, StrategyRegistry

@StrategyRegistry.register
class MyNewStrategy(BaseArbitrageStrategy):
    @property
    def metadata(self) -> StrategyMetadata:
        return StrategyMetadata(
            id="my_strategy",
            name="我的新策略",
            name_en="My New Strategy",
            description="策略描述",
            priority=6,
            requires_llm=False,
            domains=["crypto"],
            risk_level=RiskLevel.LOW,
            min_profit_threshold=2.0
        )

    def scan(self, markets, config, progress_callback=None):
        # 实现扫描逻辑
        pass
```

---

## 使用方式

在开发过程中，当你需要做出以下决策时，参考这些准则：

- **任务拆分** → 参考 2.1 小步快跑
- **完成工作后** → 参考 2.2 进度持久化
- **有新想法** → 参考 2.3 开放创新
- **优先级判断** → 参考 2.4 核心聚焦
- **LLM使用** → 参考 2.5 LLM赋能
- **新功能设计** → 参考 2.6 实证优先
- **发现新模式** → 参考 2.7 策略迭代
- **交互界面设计** → 参考 2.8-2.11 交互设计原则
